{% set lines = body | split(pat="\n") %}

<div>
{% for line in lines %}
    {% if line is starting_with("- [ ]") %}
        <input id="{{ nth }}checkbox{{ loop.index }}" type="checkbox">
        <label for="{{ nth }}checkbox{{ loop.index }}">
        {{ line | trim_start_matches(pat="- [ ]") }}
        </label>
        <br>
    {% elif line is starting_with("- [x]") %}
        <input id="{{ nth }}checkbox{{ loop.index }}" type="checkbox">
        <label for="{{ nth }}checkbox{{ loop.index }}">
        {{ line | trim_start_matches(pat="- [x]") }}
        </label>
        <br>
    {% endif %}
{% endfor %}
</div>

<div>
<details onclick="{
    const obtained = [
        {% for line in lines %}
            {% if line is starting_with('- [ ]') %}
                document.getElementById('{{ nth }}checkbox{{ loop.index }}').checked,
            {% elif line is starting_with('- [x]') %}
                document.getElementById('{{ nth }}checkbox{{ loop.index }}').checked,
            {% endif %}
        {% endfor %}
    ];
    const expected = [
        {% for line in lines %}
            {% if line is starting_with('- [ ]') %}
                document.getElementById('{{ nth }}checkbox{{ loop.index }}truth').checked,
            {% elif line is starting_with('- [x]') %}
                document.getElementById('{{ nth }}checkbox{{ loop.index }}truth').checked,
            {% endif %}
        {% endfor %}
    ];
    const correct = obtained.length == expected.length && obtained.every(function(value, idx) { return value === expected[idx]});
    console.log(correct);
    if (correct) {
        document.getElementById('{{ nth }}evaluate').innerHTML = 'âœ…';
    } else {
        document.getElementById('{{ nth }}evaluate').innerHTML = 'ğŸš«';
    }
}">
    <summary>Evaluate <span id="{{ nth }}evaluate">ğŸ¤”</span></summary>
<blockquote>

{% for line in lines %}
    {% if line is starting_with("- [ ]") %}
        <input disabled id="{{ nth }}checkbox{{ loop.index }}truth" type="checkbox">
        <label for="{{ nth }}checkbox{{ loop.index }}truth">
            {{ line | trim_start_matches(pat="- [ ]") }}
        </label>
        <br>
    {% elif line is starting_with("- [x]") %}
        <input disabled checked id="{{ nth }}checkbox{{ loop.index }}truth" type="checkbox">
        <label for="{{ nth }}checkbox{{ loop.index }}truth">
            {{ line | trim_start_matches(pat="- [x]") }}
        </label>
        <br>
    {% else %}
        <p>
        {{ line }}
        </p>
    {% endif %}
{% endfor %}


</blockquote>
</details>
</div>

<hr/>
